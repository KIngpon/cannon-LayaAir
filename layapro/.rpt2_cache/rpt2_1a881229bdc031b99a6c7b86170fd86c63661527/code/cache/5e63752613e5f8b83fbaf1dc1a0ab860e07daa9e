{
  "code": "Laya.Transform3D.prototype;\r\nexport class GameMain {\r\n    constructor() {\r\n        this.fixedTimeStep = 1.0 / 60.0;\r\n        this.maxSubSteps = 3;\r\n        this.world = new CANNON.World();\r\n        this.world.gravity.set(0, -9.82, 0);\r\n        this.world.broadphase = new CANNON.NaiveBroadphase();\r\n        Laya.loader.create(\"res/unitylib/Conventional/SampleScene.ls\", Laya.Handler.create(this, (scene) => {\r\n            Laya.stage.addChild(scene);\r\n            this.Plane = scene.getChildByName(\"Plane\");\r\n            this.Cube = scene.getChildByName(\"Cube\");\r\n            this.init();\r\n        }));\r\n        Laya.timer.frameLoop(1, this, this.update);\r\n    }\r\n    init() {\r\n        let met = new CANNON.Material();\r\n        met.friction = 100;\r\n        met.restitution = 0;\r\n        this.sphereBody = new CANNON.Body({\r\n            mass: 1,\r\n            position: new CANNON.Vec3(0, this.Cube.transform.position.y, 0),\r\n            quaternion: new CANNON.Quaternion(this.Cube.transform.rotation.x, this.Cube.transform.rotation.y, this.Cube.transform.rotation.z, this.Cube.transform.rotation.w),\r\n            shape: new CANNON.Box(new CANNON.Vec3(0.5, 0.5, 0.5)),\r\n            type: CANNON.Body.DYNAMIC,\r\n            material: met\r\n        });\r\n        this.sphereBody.collisionResponse;\r\n        this.sphereBody.addEventListener(\"collide\", a => {\r\n            console.log(\"a\", a);\r\n        });\r\n        this.world.addBody(this.sphereBody);\r\n        var groundBody = new CANNON.Body({\r\n            mass: 0\r\n        });\r\n        groundBody.material = met;\r\n        var groundShape = new CANNON.Box(new CANNON.Vec3(5, 0.01, 5));\r\n        groundBody.addShape(groundShape);\r\n        this.world.addBody(groundBody);\r\n    }\r\n    update() {\r\n        this.world.step(this.fixedTimeStep, Laya.timer.delta, this.maxSubSteps);\r\n        if (this.Cube != null) {\r\n            let posxx = this.Cube.transform.position;\r\n            posxx.setValue(this.sphereBody.position.x, this.sphereBody.position.y, this.sphereBody.position.z);\r\n            this.Cube.transform.position = posxx;\r\n            this.Cube.transform.rotation = new Laya.Quaternion(this.sphereBody.quaternion.x, this.sphereBody.quaternion.y, this.sphereBody.quaternion.z, this.sphereBody.quaternion.w);\r\n        }\r\n    }\r\n}\r\n",
  "references": []
}
